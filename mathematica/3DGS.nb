(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66874,       1455]
NotebookOptionsPosition[     63693,       1404]
NotebookOutlinePosition[     64171,       1422]
CellTagsIndexPosition[     64128,       1419]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"MultinormalDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0.5", ",", "0.3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", "1", ",", "0.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.3", ",", "0.5", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",",
      "1000"}], "]"}]}], ";"}], "\n", 
 RowBox[{"ListPointPlot3D", "[", 
  RowBox[{"data", ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"PointSize", "[", "0.02", "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9211954767962675`*^9, 3.9211954767972674`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"601dc388-6588-4ced-ae86-bea3a38bd4f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "rotatedData", ",", "scaledData", ",", "plot"}], 
       "}"}], ",", 
      RowBox[{
      "(*", "\:751f\:6210\:4e00\:4e2a\:4e09\:7ef4\:9ad8\:65af\:5206\:5e03\
\:7684\:968f\:673a\:6837\:672c", "*)"}], 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{"RandomVariate", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"100", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "\:6784\:9020\:7ed5", " ", "z", " ", 
         "\:8f74\:65cb\:8f6c\:7684\:65cb\:8f6c\:77e9\:9635"}], "*)"}], 
       RowBox[{"rotationMatrix", "=", 
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"\[Theta]", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\:6784\:9020\:7f29\:653e\:77e9\:9635", "*)"}], 
       RowBox[{"scalingMatrix", "=", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"s", ",", "s", ",", "1"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "(*", "\:5e94\:7528\:65cb\:8f6c\:548c\:7f29\:653e\:53d8\:6362", "*)"}], 
       RowBox[{"rotatedData", "=", 
        RowBox[{"data", ".", "rotationMatrix"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"scaledData", "=", 
        RowBox[{"rotatedData", ".", "scalingMatrix"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\:7ed8\:5236\:6563\:70b9\:56fe", "*)"}], 
       RowBox[{"plot", "=", 
        RowBox[{"ListPointPlot3D", "[", 
         RowBox[{"scaledData", ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"PointSize", "[", "0.02", "]"}]}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\:8fd4\:56de\:7ed8\:5236\:7684\:56fe\:5f62", "*)"}], 
       "plot"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", "\"\<Rotation Angle\>\""}], "}"}], 
      ",", "0", ",", 
      RowBox[{"2", " ", "\[Pi]"}], ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", "1", ",", "\"\<Scaling Factor\>\""}], "}"}], ",", 
      "0.1", ",", "2", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], "]"}], 
  "\n"}]], "Input",
 CellChangeTimes->{{3.9211955850427923`*^9, 3.921195585043784*^9}, 
   3.921195635829908*^9, 3.9211957178841133`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"49552466-7fbe-4ff0-a2b6-3898b77f9863"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "\:751f\:6210\:968f\:673a\:7684\:534f\:65b9\:5dee\:77e9\:9635", 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"cov", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cov", "=", 
     RowBox[{"cov", ".", 
      RowBox[{"Transpose", "[", "cov", "]"}]}]}], ";", 
    RowBox[{
    "(*", "\:786e\:4fdd\:534f\:65b9\:5dee\:77e9\:9635\:662f\:5bf9\:79f0\:6b63\
\:5b9a\:7684", "*)"}], 
    RowBox[{
    "(*", "\:751f\:6210\:9ad8\:65af\:5206\:5e03\:7684\:968f\:673a\:6837\:672c\
", "*)"}], 
    RowBox[{"data", "=", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "cov"}], "]"}], ",", 
       "1000"}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:8ba1\:7b97\:6bcf\:4e2a\:70b9\:7684\:6982\:7387\:5bc6\:5ea6\:503c",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pdfValues", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"PDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "cov"}], "]"}], 
         ",", "#"}], "]"}], "&"}], "/@", "data"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:5c06\:6982\:7387\:5bc6\:5ea6\:503c\:6620\:5c04\:5230\:989c\:8272\
\:503c", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"colors", "=", 
     RowBox[{
      RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "/@", 
      RowBox[{"Rescale", "[", "pdfValues", "]"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\:7ed8\:5236\:5e26\:989c\:8272\:7684\:70b9", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#1", ",", 
          RowBox[{"Point", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"colors", ",", "data"}], "}"}]}], "]"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "True"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
     ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.92119908423295*^9, 3.92119908423295*^9}, {
  3.9211991197594724`*^9, 3.92119913599022*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"d62df801-1d51-495a-b7f1-3fd575713d96"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.921202232116059*^9, 3.921202232116059*^9}, 
   3.9212022661135907`*^9},
 CellLabel->
  "In[129]:=",ExpressionUUID->"b77d8bc3-fdf9-4fdb-839e-fc66419c756d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rotationMatrix", ",", "scalingMatrix", ",", "graphics", ",", " ", 
       "data", ",", " ", "pdfValues", ",", " ", "colors", ",", " ", 
       "graphics1", ",", " ", "graphics2", ",", " ", "graphics3", ",", " ", 
       "graphics4"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", "\:653e\:7f29\:77e9\:9635", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"scalingMatrix", "=", 
       RowBox[{"ScalingMatrix", "[", 
        RowBox[{"{", 
         RowBox[{"sx", ",", "sy", ",", "sz"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "\:65cb\:8f6c\:77e9\:9635", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rotationMatrix", "=", 
       RowBox[{
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"\[Theta]", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ".", 
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"\[CurlyPhi]", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "\:534f\:65b9\:5dee\:77e9\:9635", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"cov", " ", "=", " ", 
       RowBox[{"rotationMatrix", ".", "scalingMatrix", ".", 
        RowBox[{"Transpose", "[", "scalingMatrix", "]"}], ".", 
        RowBox[{"Transpose", "[", "rotationMatrix", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cov2D", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"cov", ",", " ", "2", ",", " ", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"myGaussian1D", " ", ":=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"qx", ",", " ", "qy", ",", " ", "z"}], "}"}], ".", 
        RowBox[{"Inverse", "[", "cov", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"qx", ",", " ", "qy", ",", " ", "z"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "(*", "\:9ad8\:65af\:5206\:5e03\:7684\:968f\:673a\:6837\:672c", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "cov"}], "]"}], 
         ",", "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
      "(*", "\:8ba1\:7b97\:6bcf\:4e2a\:6837\:672c\:70b9\:7684\:6982\:7387\
\:5bc6\:5ea6\:503c", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pdfValues", "=", 
       RowBox[{"PDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "cov"}], "]"}], 
         ",", "data"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
      "(*", "\:6839\:636e\:6982\:7387\:5bc6\:5ea6\:503c\:6620\:5c04\:989c\
\:8272", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"colors", "=", 
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "/@", 
        RowBox[{"Rescale", "[", "pdfValues", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "(*", "\:521b\:5efa\:957f\:65b9\:4f53\:7684\:56fe\:5f62", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"graphics1", "=", 
       RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
           RowBox[{"FaceForm", "[", "LightBlue", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"GeometricTransformation", "[", 
            RowBox[{
             RowBox[{"Cuboid", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", " ", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"rotationMatrix", ".", "scalingMatrix"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}],
          ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\:521b\:5efa\:7403\:4f53\:7684\:56fe\:5f62", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"graphics2", "=", 
       RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Opacity", "[", "0.5", "]"}], ",", "Blue", ",", 
           RowBox[{"GeometricTransformation", "[", 
            RowBox[{
             RowBox[{"Sphere", "[", "]"}], ",", 
             RowBox[{"rotationMatrix", ".", "scalingMatrix"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "Red", ",", 
           RowBox[{"Thickness", "[", "0.02", "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"qx", ",", "qy", ",", 
                RowBox[{"-", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"qx", ",", "qy", ",", "2"}], "}"}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\:7ed8\:5236\:70b9", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"graphics3", "=", 
       RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#1", ",", 
                RowBox[{"Point", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"colors", ",", "data"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "splatting", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"graphics4", " ", "=", " ", 
       RowBox[{"ContourPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PDF", "[", 
          RowBox[{
           RowBox[{"MultinormalDistribution", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "cov2D"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"Contours", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.05", ",", "0.1", ",", "0.2"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ContourStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
            RowBox[{"ColorData", "[", "\"\<BlueGreenYellow\>\"", "]"}]}], 
           "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"qx", ",", "qy"}], "}"}], "]"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"1", "DGS"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sigma", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "/", 
         RowBox[{
          RowBox[{
           RowBox[{"Inverse", "[", "cov", "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mxval", " ", "=", " ", 
       RowBox[{"FindMaxValue", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", "myGaussian1D"}], "]"}], ",", " ", "z"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"mxx", " ", "=", " ", 
       RowBox[{
        RowBox[{"FindArgMax", "[", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", "myGaussian1D"}], "]"}], ",", " ", "z"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"graphics5", " ", "=", " ", 
       RowBox[{"Plot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"(", "myGaussian1D", ")"}]}], "]"}], ",", " ", 
           RowBox[{"Piecewise", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"mxval", ",", 
                RowBox[{
                 RowBox[{"z", "\[GreaterEqual]", 
                  RowBox[{
                   RowBox[{"-", "sigma"}], "+", "mxx"}]}], "&&", 
                 RowBox[{"z", "\[LessEqual]", 
                  RowBox[{"sigma", "+", "mxx"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Indeterminate", ",", "True"}], "}"}]}], "}"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "1.1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<z\>\"", ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], 
                RowBox[{"(", "myGaussian1D", ")"}]}], "]"}], "//", 
              "Simplify"}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "  ", "400"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\:8fd4\:56de\:56fe\:5f62", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Text", "[", "\"\<cov3D: \>\"", "]"}], ",", " ", 
            RowBox[{"MatrixForm", "[", "cov", "]"}], ",", " ", 
            RowBox[{"Text", "[", "\"\<  cov2D: \>\"", "]"}], ",", " ", 
            RowBox[{"MatrixForm", "[", "cov2D", "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"graphics2", ",", " ", "graphics4"}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"Text", "[", 
            RowBox[{"Simplify", "[", 
             RowBox[{"myGaussian1D", ",", " ", "z"}], "]"}], "]"}], "}"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "graphics5", ",", " ", "\"\<sigma:\>\"", ",", " ", "sigma", ",", 
            "\"\<; mu:\>\"", ",", " ", "mxx", ",", " ", "\"\<; mxval:\>\"", 
            ",", " ", "mxval"}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}],
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", "\"\<X Rotation Angle\>\""}], "}"}], 
     ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CurlyPhi]", ",", "0", ",", "\"\<Y Rotation Angle\>\""}], 
      "}"}], ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sx", ",", "1", ",", "\"\<X Scaling Factor\>\""}], "}"}], ",", 
     "0.1", ",", "2", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sy", ",", "1", ",", "\"\<Y Scaling Factor\>\""}], "}"}], ",", 
     "0.1", ",", "2", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sz", ",", "1", ",", "\"\<Z Scaling Factor\>\""}], "}"}], ",", 
     "0.1", ",", "2", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qx", ",", "0", ",", "\"\<query x\>\""}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qy", ",", "0", ",", "\"\<query y\>\""}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "\[IndentingNewLine]", "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.921195720995264*^9, 3.921195720995264*^9}, 
   3.9211958047121134`*^9, 3.921195848480007*^9, {3.9211958826835995`*^9, 
   3.921195909097294*^9}, 3.921196023227372*^9, {3.9211960910552692`*^9, 
   3.9211961378190784`*^9}, {3.9211962040127573`*^9, 3.921196337948311*^9}, {
   3.921196373151458*^9, 3.921196387463277*^9}, 3.9211964415466223`*^9, {
   3.9211965163645687`*^9, 3.9211966237310286`*^9}, {3.9211966799667454`*^9, 
   3.9211967113830695`*^9}, {3.9211967700945787`*^9, 
   3.9211967705583363`*^9}, {3.9211968046730704`*^9, 3.921196806330857*^9}, {
   3.921196866307635*^9, 3.9211968866794195`*^9}, {3.9211969171879153`*^9, 
   3.921197021198778*^9}, {3.9211970667583914`*^9, 3.9211971990098476`*^9}, {
   3.9211972357011127`*^9, 3.9211972459541187`*^9}, {3.9211972872246733`*^9, 
   3.921197294946969*^9}, {3.921197396829978*^9, 3.9211974708845844`*^9}, {
   3.92119761633221*^9, 3.9211976206840534`*^9}, {3.9211978051489787`*^9, 
   3.9211978427530994`*^9}, 3.9211979734127064`*^9, {3.921198382392067*^9, 
   3.9211984579885645`*^9}, {3.92119850922546*^9, 3.921198535437933*^9}, 
   3.9211985768740454`*^9, {3.9211987186650887`*^9, 3.9211988070674257`*^9}, {
   3.921198855824107*^9, 3.921198876022828*^9}, {3.921199191493476*^9, 
   3.9211991970864677`*^9}, {3.921199233160178*^9, 3.921199295366832*^9}, {
   3.9211993643802805`*^9, 3.921199395528881*^9}, {3.9211994360520363`*^9, 
   3.921199568353834*^9}, {3.9211996076000175`*^9, 3.9211996091837597`*^9}, 
   3.921199667855729*^9, 3.921199734422932*^9, {3.921199803908474*^9, 
   3.9211999027321515`*^9}, {3.921199955375454*^9, 3.921199995286211*^9}, {
   3.9212000447975674`*^9, 3.921200091461449*^9}, {3.921200168429061*^9, 
   3.9212001749947214`*^9}, {3.9212002146851873`*^9, 
   3.9212002152554445`*^9}, {3.921200249424584*^9, 3.9212002524417295`*^9}, {
   3.9212003402716923`*^9, 3.921200433426482*^9}, {3.9212005806286736`*^9, 
   3.9212006092*^9}, {3.9212007323673906`*^9, 3.921200747709693*^9}, {
   3.921200917636716*^9, 3.9212009221381736`*^9}, {3.921201002335884*^9, 
   3.921201057546282*^9}, {3.921201094202749*^9, 3.9212010943724976`*^9}, {
   3.921201138941831*^9, 3.9212011422051964`*^9}, {3.9212011796054726`*^9, 
   3.9212011993917537`*^9}, {3.9212012490047903`*^9, 3.921201276814042*^9}, {
   3.9212013093376436`*^9, 3.9212013104319677`*^9}, {3.9212013745267706`*^9, 
   3.921201386182556*^9}, {3.921201433826015*^9, 3.9212014462884874`*^9}, {
   3.9212014894961634`*^9, 3.921201506816365*^9}, {3.9212016206120157`*^9, 
   3.9212017341553974`*^9}, {3.921202049947194*^9, 3.921202092596074*^9}, {
   3.9212022303343196`*^9, 3.921202230734249*^9}, 3.92120226902862*^9, {
   3.9212025744348993`*^9, 3.9212026780312386`*^9}, {3.9212027625110483`*^9, 
   3.9212027657787323`*^9}, {3.9212030469703045`*^9, 
   3.9212030485676007`*^9}, {3.9212030789222546`*^9, 
   3.9212030800783873`*^9}, {3.9212031628766003`*^9, 
   3.9212031631882877`*^9}, {3.9212032031364775`*^9, 
   3.9212032036606045`*^9}, {3.9212032947042*^9, 3.9212033773917336`*^9}, {
   3.9212034624455075`*^9, 3.9212036005572667`*^9}, {3.9212037751387005`*^9, 
   3.92120391833486*^9}, {3.9212039502996893`*^9, 3.9212039504528017`*^9}, {
   3.921203991047834*^9, 3.921204041899691*^9}, {3.92120408966689*^9, 
   3.9212040908063564`*^9}, {3.921204133169552*^9, 3.9212042030919247`*^9}, {
   3.9212042355249395`*^9, 3.921204237872752*^9}, {3.9212043438475065`*^9, 
   3.9212043442349815`*^9}, {3.9212271281471033`*^9, 3.921227128229287*^9}, {
   3.921227207772668*^9, 3.92122720893596*^9}, {3.921276000390936*^9, 
   3.9212760207978525`*^9}, {3.9212760994959745`*^9, 
   3.9212761005878725`*^9}, {3.9212970677486315`*^9, 3.921297081461069*^9}, {
   3.921297111848405*^9, 3.92129712281433*^9}, {3.921297203641636*^9, 
   3.9212972051871023`*^9}, {3.922494268958691*^9, 3.922494287040728*^9}, {
   3.9249046967438583`*^9, 3.9249047007541895`*^9}, {3.924904737205167*^9, 
   3.924904781801897*^9}, {3.9249051217543664`*^9, 3.9249052038251657`*^9}, {
   3.9249052356488724`*^9, 3.9249052363605013`*^9}, {3.924905268960909*^9, 
   3.924905346693815*^9}, {3.9249054317679815`*^9, 3.9249055268702602`*^9}, {
   3.924905572285408*^9, 3.9249055979205027`*^9}, {3.9249056310527315`*^9, 
   3.924905633441019*^9}, {3.924905701082196*^9, 3.9249057639187355`*^9}, {
   3.9249058551769257`*^9, 3.9249058905419846`*^9}, {3.924906101764488*^9, 
   3.924906145808467*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"768660ae-149c-4003-8aee-2347234321f0"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`qx$$ = -0.10999999999999988`, \
$CellContext`qy$$ = 0.5, $CellContext`sx$$ = 
    1.7550000000000001`, $CellContext`sy$$ = 1.02, $CellContext`sz$$ = 
    1.1050000000000002`, $CellContext`\[Theta]$$ = -0.025132741228718558`, \
$CellContext`\[CurlyPhi]$$ = -0.025132741228718558`, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Theta]$$], 0, "X Rotation Angle"}, -Pi, Pi}, {{
       Hold[$CellContext`\[CurlyPhi]$$], 0, "Y Rotation Angle"}, -Pi, Pi}, {{
       Hold[$CellContext`sx$$], 1, "X Scaling Factor"}, 0.1, 2}, {{
       Hold[$CellContext`sy$$], 1, "Y Scaling Factor"}, 0.1, 2}, {{
       Hold[$CellContext`sz$$], 1, "Z Scaling Factor"}, 0.1, 2}, {{
       Hold[$CellContext`qx$$], 0, "query x"}, -2, 2}, {{
       Hold[$CellContext`qy$$], 0, "query y"}, -2, 2}}, Typeset`size$$ = {
    560., {267.21, 271.71}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`qx$$ = 0, $CellContext`qy$$ = 
        0, $CellContext`sx$$ = 1, $CellContext`sy$$ = 1, $CellContext`sz$$ = 
        1, $CellContext`\[Theta]$$ = 0, $CellContext`\[CurlyPhi]$$ = 0}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`rotationMatrix$, $CellContext`scalingMatrix$, \
$CellContext`graphics$, $CellContext`data$, $CellContext`pdfValues$, \
$CellContext`colors$, $CellContext`graphics1$, $CellContext`graphics2$, \
$CellContext`graphics3$, $CellContext`graphics4$}, \
$CellContext`scalingMatrix$ = 
         ScalingMatrix[{$CellContext`sx$$, $CellContext`sy$$, \
$CellContext`sz$$}]; $CellContext`rotationMatrix$ = Dot[
           RotationMatrix[$CellContext`\[Theta]$$, {1, 0, 0}], 
           
           RotationMatrix[$CellContext`\[CurlyPhi]$$, {0, 1, 
            0}]]; $CellContext`cov = 
         Dot[$CellContext`rotationMatrix$, $CellContext`scalingMatrix$, 
           Transpose[$CellContext`scalingMatrix$], 
           Transpose[$CellContext`rotationMatrix$]]; $CellContext`cov2D = 
         Take[$CellContext`cov, 2, 2]; $CellContext`myGaussian1D := 
         Dot[{$CellContext`qx$$, $CellContext`qy$$, $CellContext`z}, 
           
           Inverse[$CellContext`cov], {$CellContext`qx$$, $CellContext`qy$$, \
$CellContext`z}]; $CellContext`data$ = RandomVariate[
           MultinormalDistribution[{0, 0, 0}, $CellContext`cov], 
           10]; $CellContext`pdfValues$ = PDF[
           
           MultinormalDistribution[{0, 0, 
            0}, $CellContext`cov], $CellContext`data$]; $CellContext`colors$ = 
         Map[
           ColorData["Rainbow"], 
           Rescale[$CellContext`pdfValues$]]; $CellContext`graphics1$ = 
         Graphics3D[{
            EdgeForm[None], 
            FaceForm[LightBlue], 
            GeometricTransformation[
             Cuboid[{(-1)/2, (-1)/2, (-1)/2}], 
             Dot[$CellContext`rotationMatrix$, $CellContext`scalingMatrix$]]},
            Boxed -> False, Axes -> True, AxesLabel -> {"X", "Y", "Z"}, 
           PlotRange -> {{-2, 2}, {-2, 2}, {-2, 2}}, ImageSize -> 400, 
           ViewPoint -> {0, 0, Infinity}]; $CellContext`graphics2$ = 
         Graphics3D[{
            Opacity[0.5], Blue, 
            GeometricTransformation[
             Sphere[], 
             Dot[$CellContext`rotationMatrix$, $CellContext`scalingMatrix$]], 
            Red, 
            Thickness[0.02], 
            
            Line[{{$CellContext`qx$$, $CellContext`qy$$, -2}, \
{$CellContext`qx$$, $CellContext`qy$$, 2}}]}, Boxed -> False, Axes -> True, 
           AxesLabel -> {"X", "Y", "Z"}, 
           PlotRange -> {{-2, 2}, {-2, 2}, {-2, 2}}, ImageSize -> 400, 
           ViewPoint -> {0, 0, Infinity}]; $CellContext`graphics3$ = 
         Graphics3D[{
            PointSize[0.01], 
            MapThread[{#, 
              Point[#2]}& , {$CellContext`colors$, $CellContext`data$}]}, 
           Boxed -> False, Axes -> True, AxesLabel -> {"X", "Y", "Z"}, 
           PlotRange -> {{-2, 2}, {-2, 2}, {-2, 2}}, ImageSize -> 400, 
           ViewPoint -> {0, 0, Infinity}]; $CellContext`graphics4$ = 
         ContourPlot[
           PDF[
            
            MultinormalDistribution[{0, 
             0}, $CellContext`cov2D], {$CellContext`x, $CellContext`y}], \
{$CellContext`x, -2, 2}, {$CellContext`y, -2, 2}, 
           Contours -> {0.05, 0.1, 0.2}, ContourStyle -> Directive[
             Opacity[0.5], 
             ColorData["BlueGreenYellow"]], FrameLabel -> {"x", "y"}, 
           AspectRatio -> Automatic, ImageSize -> 400, Epilog -> {Red, 
             PointSize[0.02], 
             
             Point[{$CellContext`qx$$, $CellContext`qy$$}]}]; \
$CellContext`sigma = Sqrt[1/Part[
            Part[
             Inverse[$CellContext`cov], 3], 3]]; $CellContext`mxval = 
         FindMaxValue[
           Exp[-$CellContext`myGaussian1D], $CellContext`z]; $CellContext`mxx = 
         Part[
           FindArgMax[
            Exp[-$CellContext`myGaussian1D], $CellContext`z], 
           1]; $CellContext`graphics5 = Plot[{
            Exp[-$CellContext`myGaussian1D], 
            Piecewise[{{$CellContext`mxval, 
               
               And[$CellContext`z >= -$CellContext`sigma + $CellContext`mxx, \
$CellContext`z <= $CellContext`sigma + $CellContext`mxx]}, {
              Indeterminate, True}}]}, {$CellContext`z, -2, 2}, 
           PlotRange -> {Automatic, {0, 1.1}}, AxesLabel -> {"z", 
             Text[
              Simplify[
               Exp[((-1)/2) $CellContext`myGaussian1D]]]}, ImageSize -> 400]; 
        Column[{
           Row[{
             Text["cov3D: "], 
             MatrixForm[$CellContext`cov], 
             Text["  cov2D: "], 
             MatrixForm[$CellContext`cov2D]}], 
           Row[{$CellContext`graphics2$, $CellContext`graphics4$}], 
           Row[{
             Text[
              Simplify[$CellContext`myGaussian1D, $CellContext`z]]}], 
           
           Row[{$CellContext`graphics5, "sigma:", $CellContext`sigma, 
             "; mu:", $CellContext`mxx, "; mxval:", $CellContext`mxval}]}]], 
      "Specifications" :> {{{$CellContext`\[Theta]$$, 0, 
          "X Rotation Angle"}, -Pi, Pi, Appearance -> 
         "Labeled"}, {{$CellContext`\[CurlyPhi]$$, 0, "Y Rotation Angle"}, -
         Pi, Pi, Appearance -> 
         "Labeled"}, {{$CellContext`sx$$, 1, "X Scaling Factor"}, 0.1, 2, 
         Appearance -> 
         "Labeled"}, {{$CellContext`sy$$, 1, "Y Scaling Factor"}, 0.1, 2, 
         Appearance -> 
         "Labeled"}, {{$CellContext`sz$$, 1, "Z Scaling Factor"}, 0.1, 2, 
         Appearance -> "Labeled"}, {{$CellContext`qx$$, 0, "query x"}, -2, 2, 
         Appearance -> "Labeled"}, {{$CellContext`qy$$, 0, "query y"}, -2, 2, 
         Appearance -> "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{596., {349.25, 353.75}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.9212041819538784`*^9, 3.921204204320221*^9}, 
   3.9212042398012366`*^9, 3.9212043449675655`*^9, 3.921227132230399*^9, 
   3.921227209951564*^9, 3.921276021310238*^9, 3.9212761008753777`*^9, 
   3.9212971233011866`*^9, 3.9212972070659447`*^9, {3.922494270368558*^9, 
   3.9224942889588575`*^9}, 3.9245738016810727`*^9, 3.92490467210619*^9, {
   3.9249051581484537`*^9, 3.924905207751406*^9}, 3.9249052393513165`*^9, {
   3.924905269429557*^9, 3.9249053513749514`*^9}, {3.924905474999956*^9, 
   3.924905528669305*^9}, {3.9249055742694826`*^9, 3.9249055982851467`*^9}, {
   3.92490572114832*^9, 3.9249057641868105`*^9}, 3.924905859787315*^9, {
   3.9249058908764153`*^9, 3.9249059155146217`*^9}, 3.9249059952729053`*^9, {
   3.924906119654768*^9, 3.9249061465951624`*^9}, 3.924906395295594*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"06b8298c-c572-456d-b0ec-6e9b61823cd7"],

Cell[BoxData[
 TemplateBox[{
  "MultinormalDistribution", "posdefprm", 
   "\"The value \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
\\\"0.0001038776822414665`\\\", \\\",\\\", \\\"0.0010298070906921766`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.0001038776822414665`\
\\\", \\\",\\\", \\\"1.0404002620726132`\\\", \\\",\\\", \
\\\"2.5980964274974205`*^-6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.0010298070906921766`\\\", \\\",\\\", \
\\\"2.5980964275112983`*^-6\\\", \\\",\\\", \\\"1.040425756621303`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]\\) at position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{RowBox[{\
\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
\\\"0.0001038776822414665`\\\", \\\",\\\", \\\"0.0010298070906921766`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.0001038776822414665`\
\\\", \\\",\\\", \\\"1.0404002620726132`\\\", \\\",\\\", \
\\\"2.5980964274974205`*^-6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.0010298070906921766`\\\", \\\",\\\", \
\\\"2.5980964275112983`*^-6\\\", \\\",\\\", \\\"1.040425756621303`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) is expected to be a symmetric \
positive definite matrix.\"", 2, 1, 27, 28157986317238000399, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.92534531334801*^9},
 CellLabel->"",ExpressionUUID->"95866606-1956-4a99-91a4-27da2cbb6853"],

Cell[BoxData[
 TemplateBox[{
  "MultinormalDistribution", "posdefprm", 
   "\"The value \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
\\\"0.0001038776822414665`\\\", \\\",\\\", \\\"0.0010298070906921766`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.0001038776822414665`\
\\\", \\\",\\\", \\\"1.0404002620726132`\\\", \\\",\\\", \
\\\"2.5980964274974205`*^-6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.0010298070906921766`\\\", \\\",\\\", \
\\\"2.5980964275112983`*^-6\\\", \\\",\\\", \\\"1.040425756621303`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]\\) at position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{RowBox[{\
\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
\\\"0.0001038776822414665`\\\", \\\",\\\", \\\"0.0010298070906921766`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.0001038776822414665`\
\\\", \\\",\\\", \\\"1.0404002620726132`\\\", \\\",\\\", \
\\\"2.5980964274974205`*^-6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.0010298070906921766`\\\", \\\",\\\", \
\\\"2.5980964275112983`*^-6\\\", \\\",\\\", \\\"1.040425756621303`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) is expected to be a symmetric \
positive definite matrix.\"", 2, 1, 28, 28157986317238000399, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9253453133956633`*^9},
 CellLabel->"",ExpressionUUID->"8cc54db6-dd09-4fc9-ad15-56169bc41bf4"],

Cell[BoxData[
 TemplateBox[{
  "Rescale", "nargs", 
   "\"If the first argument is not a list or a SparseArray, two or three \
arguments are expected.\"", 2, 1, 29, 28157986317238000399, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.925345313411545*^9},
 CellLabel->"",ExpressionUUID->"599af3a4-8a30-4926-ba7c-306a587b57c8"],

Cell[BoxData[
 TemplateBox[{
  "Rescale", "nargs", 
   "\"If the first argument is not a list or a SparseArray, two or three \
arguments are expected.\"", 2, 1, 30, 28157986317238000399, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9253453134426994`*^9},
 CellLabel->"",ExpressionUUID->"1d9831d2-7366-455f-bdc4-87cfe15845ae"],

Cell[BoxData[
 TemplateBox[{
  "MapThread", "mptd", 
   "\"Object \\!\\(\\*RowBox[{\\\"Rescale\\\", \\\"[\\\", RowBox[{\\\"Blend\\\
\", \\\"[\\\", RowBox[{\\\"\\\\\\\"Rainbow\\\\\\\"\\\", \\\",\\\", RowBox[{\\\
\"PDF\\\", \\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
\\\"0.0001038776822414665`\\\", \\\",\\\", \\\"0.0010298070906921766`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.0001038776822414665`\
\\\", \\\",\\\", \\\"1.0404002620726132`\\\", \\\",\\\", \
\\\"2.5980964274974205`*^-6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.0010298070906921766`\\\", \\\",\\\", \
\\\"2.5980964275112983`*^-6\\\", \\\",\\\", \\\"1.040425756621303`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"RandomVariate\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]}], \
\\\"]\\\"}], \\\"]\\\"}]\\) at position {2, \\!\\(\\*RowBox[{\\\"1\\\"}]\\)} \
in \\!\\(\\*RowBox[{\\\"MapThread\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"#1\\\", \\\",\\\", \
RowBox[{\\\"Point\\\", \\\"[\\\", \\\"#2\\\", \\\"]\\\"}]}], \\\"}\\\"}], \
\\\"&\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Rescale\\\", \
\\\"[\\\", RowBox[{\\\"Blend\\\", \\\"[\\\", \
RowBox[{\\\"\\\\\\\"Rainbow\\\\\\\"\\\", \\\",\\\", RowBox[{\\\"PDF\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\
\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"RandomVariate\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \
\\\"]\\\"}], \\\",\\\", \\\"10\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]}], \
\\\"]\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"RandomVariate\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"22\\\", \\\"\[RightSkeleton]\\\"}], \
\\\",\\\", \\\"0.0010298070906921766`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \\\"10\\\
\"}], \\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) has only \\!\\(\\*RowBox[{\
\\\"0\\\"}]\\) of required \\!\\(\\*RowBox[{\\\"1\\\"}]\\) dimensions.\"", 2, 
   1, 31, 28157986317238000399, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9253453134739447`*^9},
 CellLabel->"",ExpressionUUID->"5fc572e0-b2fd-40df-b77f-ce0597d0d591"],

Cell[BoxData[
 TemplateBox[{
  "MultinormalDistribution", "posdefprm", 
   "\"The value \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
\\\"0.0001038776822414665`\\\", \\\",\\\", \\\"0.0010298070906921766`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.0001038776822414665`\
\\\", \\\",\\\", \\\"1.0404002620726132`\\\", \\\",\\\", \
\\\"2.5980964274974205`*^-6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.0010298070906921766`\\\", \\\",\\\", \
\\\"2.5980964275112983`*^-6\\\", \\\",\\\", \\\"1.040425756621303`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]\\) at position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{RowBox[{\
\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
\\\"0.0001038776822414665`\\\", \\\",\\\", \\\"0.0010298070906921766`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.0001038776822414665`\
\\\", \\\",\\\", \\\"1.0404002620726132`\\\", \\\",\\\", \
\\\"2.5980964274974205`*^-6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.0010298070906921766`\\\", \\\",\\\", \
\\\"2.5980964275112983`*^-6\\\", \\\",\\\", \\\"1.040425756621303`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) is expected to be a symmetric \
positive definite matrix.\"", 2, 1, 32, 28157986317238000399, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9253453136791754`*^9},
 CellLabel->"",ExpressionUUID->"5113295e-6fc9-4257-9cbf-6395a0288355"],

Cell[BoxData[
 TemplateBox[{
  "MultinormalDistribution", "posdefprm", 
   "\"The value \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
\\\"0.0001038776822414665`\\\", \\\",\\\", \\\"0.0010298070906921766`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.0001038776822414665`\
\\\", \\\",\\\", \\\"1.0404002620726132`\\\", \\\",\\\", \
\\\"2.5980964274974205`*^-6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.0010298070906921766`\\\", \\\",\\\", \
\\\"2.5980964275112983`*^-6\\\", \\\",\\\", \\\"1.040425756621303`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]\\) at position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{RowBox[{\
\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
\\\"0.0001038776822414665`\\\", \\\",\\\", \\\"0.0010298070906921766`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.0001038776822414665`\
\\\", \\\",\\\", \\\"1.0404002620726132`\\\", \\\",\\\", \
\\\"2.5980964274974205`*^-6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.0010298070906921766`\\\", \\\",\\\", \
\\\"2.5980964275112983`*^-6\\\", \\\",\\\", \\\"1.040425756621303`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) is expected to be a symmetric \
positive definite matrix.\"", 2, 1, 33, 28157986317238000399, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9253453136943264`*^9},
 CellLabel->"",ExpressionUUID->"996ed7e2-0f77-4866-9a69-e07ebcf02051"],

Cell[BoxData[
 TemplateBox[{
  "Rescale", "nargs", 
   "\"If the first argument is not a list or a SparseArray, two or three \
arguments are expected.\"", 2, 1, 34, 28157986317238000399, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.925345313733258*^9},
 CellLabel->"",ExpressionUUID->"8089aa79-c74f-40fa-9a61-737033220a27"],

Cell[BoxData[
 TemplateBox[{
  "Rescale", "nargs", 
   "\"If the first argument is not a list or a SparseArray, two or three \
arguments are expected.\"", 2, 1, 35, 28157986317238000399, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.925345313757518*^9},
 CellLabel->"",ExpressionUUID->"722e9b8e-83a2-4f42-a729-e39ad63a7687"],

Cell[BoxData[
 TemplateBox[{
  "MapThread", "mptd", 
   "\"Object \\!\\(\\*RowBox[{\\\"Rescale\\\", \\\"[\\\", RowBox[{\\\"Blend\\\
\", \\\"[\\\", RowBox[{\\\"\\\\\\\"Rainbow\\\\\\\"\\\", \\\",\\\", RowBox[{\\\
\"PDF\\\", \\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
\\\"0.0001038776822414665`\\\", \\\",\\\", \\\"0.0010298070906921766`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.0001038776822414665`\
\\\", \\\",\\\", \\\"1.0404002620726132`\\\", \\\",\\\", \
\\\"2.5980964274974205`*^-6\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.0010298070906921766`\\\", \\\",\\\", \
\\\"2.5980964275112983`*^-6\\\", \\\",\\\", \\\"1.040425756621303`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"RandomVariate\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]}], \
\\\"]\\\"}], \\\"]\\\"}]\\) at position {2, \\!\\(\\*RowBox[{\\\"1\\\"}]\\)} \
in \\!\\(\\*RowBox[{\\\"MapThread\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"#1\\\", \\\",\\\", \
RowBox[{\\\"Point\\\", \\\"[\\\", \\\"#2\\\", \\\"]\\\"}]}], \\\"}\\\"}], \
\\\"&\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Rescale\\\", \
\\\"[\\\", RowBox[{\\\"Blend\\\", \\\"[\\\", \
RowBox[{\\\"\\\\\\\"Rainbow\\\\\\\"\\\", \\\",\\\", RowBox[{\\\"PDF\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\
\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"RandomVariate\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \
\\\"]\\\"}], \\\",\\\", \\\"10\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]}], \
\\\"]\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"RandomVariate\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.081573981306084`\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"22\\\", \\\"\[RightSkeleton]\\\"}], \
\\\",\\\", \\\"0.0010298070906921766`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \\\"10\\\
\"}], \\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) has only \\!\\(\\*RowBox[{\
\\\"0\\\"}]\\) of required \\!\\(\\*RowBox[{\\\"1\\\"}]\\) dimensions.\"", 2, 
   1, 36, 28157986317238000399, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9253453137885585`*^9},
 CellLabel->"",ExpressionUUID->"85f1d476-a9ef-4f2b-93fd-28bb367356a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a0", ",", " ", "a1", ",", " ", "a2"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"a1", ",", " ", "a3", ",", " ", "a4"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"a2", ",", " ", "a4", ",", " ", "a5"}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", " ", 
      RowBox[{"{", "y", "}"}], ",", " ", 
      RowBox[{"{", "z", "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", "res", "\[IndentingNewLine]", 
 RowBox[{"coef", " ", "=", " ", 
  RowBox[{
   RowBox[{"CoefficientList", "[", 
    RowBox[{"res", ",", " ", "z"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"a", " ", "=", " ", 
  RowBox[{"coef", "[", 
   RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"b", " ", "=", " ", 
  RowBox[{"coef", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"c", " ", "=", " ", 
  RowBox[{"coef", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.924905936256316*^9, 3.9249059538515043`*^9}, 
   3.924905987769575*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"7bf2f002-ec93-4df1-ad3f-d079120fab2e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a0", " ", "x"}], "+", 
      RowBox[{"a1", " ", "y"}], "+", 
      RowBox[{"a2", " ", "z"}]}], ")"}]}], "+", 
   RowBox[{"y", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a1", " ", "x"}], "+", 
      RowBox[{"a3", " ", "y"}], "+", 
      RowBox[{"a4", " ", "z"}]}], ")"}]}], "+", 
   RowBox[{"z", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a2", " ", "x"}], "+", 
      RowBox[{"a4", " ", "y"}], "+", 
      RowBox[{"a5", " ", "z"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9212759808991785`*^9, 3.924905954687188*^9, 
  3.9249059917889037`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"1f166b19-054b-4c2d-ab00-7fd19277e723"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a0", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"2", " ", "a1", " ", "x", " ", "y"}], "+", 
    RowBox[{"a3", " ", 
     SuperscriptBox["y", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "a2", " ", "x"}], "+", 
    RowBox[{"2", " ", "a4", " ", "y"}]}], ",", "a5"}], "}"}]], "Output",
 CellChangeTimes->{3.9212759808991785`*^9, 3.924905954687188*^9, 
  3.924905991790897*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"c9aa770a-731b-40f1-86f6-01bb472fa4c2"],

Cell[BoxData["a5"], "Output",
 CellChangeTimes->{3.9212759808991785`*^9, 3.924905954687188*^9, 
  3.9249059917979493`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"e436975d-f780-44cc-befe-257f8e143aee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "a2", " ", "x"}], "+", 
  RowBox[{"2", " ", "a4", " ", "y"}]}]], "Output",
 CellChangeTimes->{3.9212759808991785`*^9, 3.924905954687188*^9, 
  3.9249059917999573`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"ab5edd3c-8f92-4439-b518-5b99a2f02686"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a0", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  RowBox[{"2", " ", "a1", " ", "x", " ", "y"}], "+", 
  RowBox[{"a3", " ", 
   SuperscriptBox["y", "2"]}]}]], "Output",
 CellChangeTimes->{3.9212759808991785`*^9, 3.924905954687188*^9, 
  3.9249059918019032`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"99c6d304-3cb0-47fd-b160-906f9acf60da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"res", " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", " ", "c"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"b", ",", " ", "d", ",", " ", "e"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"c", ",", " ", "e", ",", "f"}], "}"}]}], "}"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", " ", 
     RowBox[{"{", "y", "}"}], ",", " ", 
     RowBox[{"{", "z", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"res", "//", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{"#", ",", " ", "z"}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"coef", " ", "=", " ", 
  RowBox[{
   RowBox[{"CoefficientList", "[", 
    RowBox[{"res", ",", " ", "z"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.924574741666154*^9, 3.92457485400629*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"5fa9c00d-d9bc-450e-8d6f-2f1370f0a339"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "x"}], "+", 
      RowBox[{"b", " ", "y"}], "+", 
      RowBox[{"c", " ", "z"}]}], ")"}]}], "+", 
   RowBox[{"y", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", " ", "x"}], "+", 
      RowBox[{"d", " ", "y"}], "+", 
      RowBox[{"e", " ", "z"}]}], ")"}]}], "+", 
   RowBox[{"z", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "x"}], "+", 
      RowBox[{"e", " ", "y"}], "+", 
      RowBox[{"f", " ", "z"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9245747574284477`*^9, 3.924574824221127*^9}, 
   3.9245748543700776`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"c698aa51-5fe2-498c-9ed1-21f6989f91e1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{"2", " ", "b", " ", "x", " ", "y"}], "+", 
   RowBox[{"d", " ", 
    SuperscriptBox["y", "2"]}], "+", 
   RowBox[{"2", " ", "c", " ", "x", " ", "z"}], "+", 
   RowBox[{"2", " ", "e", " ", "y", " ", "z"}], "+", 
   RowBox[{"f", " ", 
    SuperscriptBox["z", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9245747574284477`*^9, 3.924574824221127*^9}, 
   3.92457485437507*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"cd658300-c9ca-4e53-8ae2-cddc3b41cf8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"2", " ", "b", " ", "x", " ", "y"}], "+", 
    RowBox[{"d", " ", 
     SuperscriptBox["y", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "c", " ", "x"}], "+", 
    RowBox[{"2", " ", "e", " ", "y"}]}], ",", "f"}], "}"}]], "Output",
 CellChangeTimes->{{3.9245747574284477`*^9, 3.924574824221127*^9}, 
   3.9245748543765817`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"7cabe46a-e70f-4c85-8694-95e700116e3d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{
         RowBox[{"x", "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"x", "\[LessEqual]", "3"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Indeterminate", ",", "True"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9249047852762933`*^9, 3.9249047990393896`*^9}, {
  3.924905001910714*^9, 3.9249050608051834`*^9}, {3.924905105563941*^9, 
  3.9249051056667767`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"6f1c624f-9dd5-4bf8-b13f-7aaf690132b4"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQnRNxV3pGCJs9AwQ4fFhu9dai1B/ONxDm/ej6NA3O
P/PJZd2sqio4n2Edo5HnwRY438Rhv9+cjJlw/pYrdkxeFkvg/C/z/t1WWLAR
zu+7fHebjMpOOP9d/O74iB1H4HzRa+wpi+6dgfOX/VVS/s11Dc7P6pubFdJw
F86P23Do7d/Tj+D8g8/nz2mc9AzOf7XfOEFn1Ss4Xz3867l1697B+f5yArM+
mH2E8/MeMoTL2n+G81d5q/EvUvkK53uyLQ/cZfQdzi9asC/TzvwnnL/jIVet
lORvOD+peJNUl/JfOF9zTd/mQO7/cL7tI4aJh0qA4QrlTxfL4FWrYITzG+Zl
tptmMcH5s8/NONZXwAznV+dN/iBbxALnv0zUkIhMYoXzO/++YrmXxgbnK5RK
VpU9QPB3vHF/zxfFDueXskxasmIqgm8kcyfS6SKCr7hI77jGAwRfQKPRhP89
gs+RrZXd9A3B/7/28sKvfxH8Hf9q8y/9R/ABXoehSw==
       "]]},
     Annotation[#, "Charting`Private`Tag$25996#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-1, 5}, {0., 4.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.9249047917457533`*^9, 3.924904799798752*^9}, {
   3.9249050189790196`*^9, 3.92490506114524*^9}, 3.9249051066991673`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"854b49fb-1373-49cb-ab40-1be64fa0ef66"]
}, Open  ]]
},
WindowSize->{1011., 729.75},
WindowMargins->{{Automatic, 205.5}, {Automatic, 0}},
TaggingRules->{"TryRealOnly" -> False},
Magnification:>0.7 Inherited,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 7, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"24ee60ae-91eb-4550-9880-6c36052eb951"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 891, 23, 33, "Input",ExpressionUUID->"601dc388-6588-4ced-ae86-bea3a38bd4f0"],
Cell[1452, 45, 3396, 84, 118, "Input",ExpressionUUID->"49552466-7fbe-4ff0-a2b6-3898b77f9863"],
Cell[4851, 131, 2865, 79, 170, "Input",ExpressionUUID->"d62df801-1d51-495a-b7f1-3fd575713d96"],
Cell[7719, 212, 253, 5, 21, "Input",ExpressionUUID->"b77d8bc3-fdf9-4fdb-839e-fc66419c756d"],
Cell[CellGroupData[{
Cell[7997, 221, 21614, 473, 1215, "Input",ExpressionUUID->"768660ae-149c-4003-8aee-2347234321f0"],
Cell[29614, 696, 8648, 166, 716, "Output",ExpressionUUID->"06b8298c-c572-456d-b0ec-6e9b61823cd7"],
Cell[38265, 864, 1704, 26, 38, "Message",ExpressionUUID->"95866606-1956-4a99-91a4-27da2cbb6853"],
Cell[39972, 892, 1707, 26, 38, "Message",ExpressionUUID->"8cc54db6-dd09-4fc9-ad15-56169bc41bf4"],
Cell[41682, 920, 350, 7, 17, "Message",ExpressionUUID->"599af3a4-8a30-4926-ba7c-306a587b57c8"],
Cell[42035, 929, 352, 7, 17, "Message",ExpressionUUID->"1d9831d2-7366-455f-bdc4-87cfe15845ae"],
Cell[42390, 938, 3732, 54, 66, "Message",ExpressionUUID->"5fc572e0-b2fd-40df-b77f-ce0597d0d591"],
Cell[46125, 994, 1707, 26, 38, "Message",ExpressionUUID->"5113295e-6fc9-4257-9cbf-6395a0288355"],
Cell[47835, 1022, 1707, 26, 38, "Message",ExpressionUUID->"996ed7e2-0f77-4866-9a69-e07ebcf02051"],
Cell[49545, 1050, 350, 7, 17, "Message",ExpressionUUID->"8089aa79-c74f-40fa-9a61-737033220a27"],
Cell[49898, 1059, 350, 7, 17, "Message",ExpressionUUID->"722e9b8e-83a2-4f42-a729-e39ad63a7687"],
Cell[50251, 1068, 3732, 54, 66, "Message",ExpressionUUID->"85f1d476-a9ef-4f2b-93fd-28bb367356a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54020, 1127, 1383, 36, 86, "Input",ExpressionUUID->"7bf2f002-ec93-4df1-ad3f-d079120fab2e"],
Cell[55406, 1165, 761, 23, 23, "Output",ExpressionUUID->"1f166b19-054b-4c2d-ab00-7fd19277e723"],
Cell[56170, 1190, 535, 14, 27, "Output",ExpressionUUID->"c9aa770a-731b-40f1-86f6-01bb472fa4c2"],
Cell[56708, 1206, 200, 3, 23, "Output",ExpressionUUID->"e436975d-f780-44cc-befe-257f8e143aee"],
Cell[56911, 1211, 289, 6, 23, "Output",ExpressionUUID->"ab5edd3c-8f92-4439-b518-5b99a2f02686"],
Cell[57203, 1219, 373, 9, 24, "Output",ExpressionUUID->"99c6d304-3cb0-47fd-b160-906f9acf60da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57613, 1233, 1059, 28, 46, "Input",ExpressionUUID->"5fa9c00d-d9bc-450e-8d6f-2f1370f0a339"],
Cell[58675, 1263, 756, 23, 23, "Output",ExpressionUUID->"c698aa51-5fe2-498c-9ed1-21f6989f91e1"],
Cell[59434, 1288, 567, 14, 27, "Output",ExpressionUUID->"cd658300-c9ca-4e53-8ae2-cddc3b41cf8d"],
Cell[60004, 1304, 535, 14, 27, "Output",ExpressionUUID->"7cabe46a-e70f-4c85-8694-95e700116e3d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60576, 1323, 739, 19, 21, "Input",ExpressionUUID->"6f1c624f-9dd5-4bf8-b13f-7aaf690132b4"],
Cell[61318, 1344, 2359, 57, 170, "Output",ExpressionUUID->"854b49fb-1373-49cb-ab40-1be64fa0ef66"]
}, Open  ]]
}
]
*)

